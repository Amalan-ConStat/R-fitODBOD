---
title: "R-fitODBOD"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE)
```

[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version-last-release/fitODBOD)](https://cran.r-project.org/package=fitODBOD)
[![packageversion](https://img.shields.io/badge/Package%20version-1.3.0-orange.svg?style=flat-square)](commits/master)
[![Rdoc](http://www.rdocumentation.org/badges/version/fitODBOD)](http://www.rdocumentation.org/packages/fitODBOD)

![downloads](http://cranlogs.r-pkg.org/badges/grand-total/fitODBOD)
![downloads](https://cranlogs.r-pkg.org/badges/fitODBOD)
![downloads](http://cranlogs.r-pkg.org/badges/last-week/fitODBOD)

[![Licence](https://img.shields.io/badge/licence-GPL--2-blue.svg)](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html)
[![GitHub license](https://img.shields.io/github/license/Amalan-ConStat/R-fitODBOD.svg?style=popout)](https://github.com/Amalan-ConStat/R-fitODBOD/blob/master/LICENSE)

[![Project Status: Active - The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![GitHub issues](https://img.shields.io/github/issues/Amalan-ConStat/R-fitODBOD.svg?style=popout)](https://github.com/Amalan-ConStat/R-fitODBOD/issues)

[![rpackages.io rank](http://www.rpackages.io/badge/fitODBOD.svg)](http://www.rpackages.io/package/fitODBOD)

# fitODBOD <img src="man/figures/logo.png" align="right" alt="" width="150" />

## How to engage with "fitODBOD" the first time ?
```{r fitODBOD from GitHub or CRAN,eval=FALSE}
## Installing the package from GitHub
devtools::install_github("Amalan-ConStat/R-fitODBOD")

## Installing the package from CRAN
install.packages("fitODBOD")
```
## Key Phrases
* BOD (Binomial Outcome Data)
* Over Dispersion
* Under Dispersion
* BMD (Binomial Mixture Distributions)
* ABD (Alternate Binomial Distributions)
* PMF (Probability Mass Function)
* CPMF (Cumulative Probability Mass Function)

## What does "fitODBOD" ?
You can understand BMD & ABD with PMF & CPMF. Further, BOD can be modeled using these Distributions

## Distributions

| Alternate Binomial Distributions | Binomial Mixture Distributions |
|:--------------------------------|:-------------------------------|
|1.Additive Binomial Distribution|1.Uniform Binomial Distribution |
|2.Beta-Correlated Binomial Distribution|2.Triangular Binomial Distribution|
|3.COM Poisson Binomial Distribution|3.Beta-Binomial Distribution|
|4.Correlated Binomial Distribution|4.Kumaraswamy Binomial Distribution|
|5.Multiplicative Binomial Distribution|5.Gaussian Hypergeometric Generalized Beta-Binomial Distribution|
|6.Lovinson Multiplicative Binomial Distribution|6.McDonald Generalized Beta-Binomial Distribution|
||7.Gamma Binomial Distribution|
||8.Grassia II Binomial Distribution|


## Just an example
### Modelling BOD using Beta-Binomial Distribution
```{r Alcohol Data}
library(fitODBOD)

#Looking at the BOD
Alcohol_data
```

Hypothesis to check if above data follows Binomial Distribution

H~0~ : The Data follows the Binomial Distribution. 

H~1~ : The Data does not follow the Binomial Distribution.

```{r Fitting Binomial Distribution}
#Checking if the above data  of Days and week2 follows Binomial Distribution
fitB<-fitBin(Alcohol_data$Days,Alcohol_data$week2)

print(fitB)
```

According to p-value= 0, H~0~ is rejected at 5\% significance level.

```{r Estimating shape parameters a,b using given BOD,warning=FALSE}
#Estimating the parameters a and b using bbmle package mle2 function
BetaBin=bbmle::mle2(EstMLEBetaBin,data=list(x=Alcohol_data$Days,
                        freq=Alcohol_data$week2), start=list(a=100.1,b=100.1))
a_est=bbmle::coef(BetaBin)[1]                    
b_est=bbmle::coef(BetaBin)[2]
```

Now, Checking if above data follows Beta-Binomial Distribution

H~0~ : The Data follows the Beta-Binomial Distribution. 

H~1~ : The Data does not follow the Beta-Binomial Distribution.

```{r Fitting Beta-Binomial Distribution}
#Checking if the above data follows Beta-Binomial Distribution
fitBB<-fitBetaBin(Alcohol_data$Days,Alcohol_data$week2,a_est,b_est)

print(fitBB)
```

p-value=0.1524 indicates H~0~ is not rejected at 5\% significance level.
Clearly Beta-Binomial Distribution is a better suit for the Alcohol BOD.

Further 
```{r Comparing Variances,}
#Actual Variance
Act_Var<-var(rep(Alcohol_data$Days,Alcohol_data$week2))
#Estimated Variance of Binomial Distribution
Est_Var_Bin<-var(rep(Alcohol_data$Days,fitted(fitB)))
#Estimated Variance of Beta-Binomial Distribution
Est_Var_BetaBin<-var(rep(Alcohol_data$Days,fitted(fitBB)))
```

```{r Printing variance and plotting frequencies,echo=FALSE}
Var_table<-tibble::tibble(x=c("Actual","From Expected frequencies of estimated Binomial Distribution"
                              ,"From Expected frequencies of estimated Beta-Binomial Distribution"),
                          y=c(Act_Var,Est_Var_Bin,Est_Var_BetaBin))
names(Var_table)<-c("Type of Variance","Values")
knitr::kable(Var_table)

results_data<-tibble::tibble(
                             "Days"=Alcohol_data$Days,
                             "Week2"=Alcohol_data$week2,
                             "BinomialFreq"=fitted(fitB),
                             "BetaBinomialFreq"=fitted(fitBB)
                             )

library(ggplot2)
plotBOD<-ggplot(results_data)+theme_get()+
                     geom_point(aes(x=Days,y=Week2),color="red")+
                     geom_line(aes(x=Days,y=Week2),color="red")+
                     geom_point(aes(x=Days,y=BinomialFreq),color="green")+
                     geom_line(aes(x=Days,y=BinomialFreq),color="green")+
                     geom_point(aes(x=Days,y=BetaBinomialFreq),color="blue")+
                     geom_line(aes(x=Days,y=BetaBinomialFreq),color="blue")+
                     ggtitle("Using ggplot to compare frequencies of Alcohol BOD")+
                     xlab("Binomial Random Variables from 0 to 7")+
                     ylab("Frequency Values Estimated and Actual")+
                     scale_y_continuous(breaks=seq(0,120,10))+
                     scale_x_continuous(breaks=seq(0,7,1))+
                     annotate("text",x=1.5,y=55,label="Actual",color="Red")+
                     annotate("text",x=4.5,y=115,label="Binomial",color="Green")+
                     annotate("text",x=4.75,y=55,label="Beta-Binomial",color="Blue")

plotly::plotly_build(plotBOD)
```

Variance(5.8043) from Beta-Binomial Distribution's estimated frequencies is closer to 
the Actual Variance(5.7873) of Alcohol BOD week 2 than variance(1.6945) of expected frequencies by 
Binomial Distribution.

According to the plot, it is clearly seen that Beta-Binomial estimated frequencies behave very close to actual
frequency values than the estimate frequencies from Binomial distribution. Or the Red line is very similar and
close to the Blue line than the Green line.

## Thank You

[![Twitter](https://img.shields.io/twitter/url/https/github.com/Amalan-ConStat/R-fitODBOD.svg?style=social)](https://twitter.com/intent/tweet?text=Wow:&url=https%3A%2F%2Fgithub.com%2FAmalan-ConStat%2FR-fitODBOD)

[ ![](https://img.shields.io/badge/LinkedIn-Amalan%20Mahendran-black.svg?style=flat) ]( https://www.linkedin.com/in/amalan-mahendran-72b86b37/)
[ ![](https://img.shields.io/badge/Research%20Gate-Amalan%20Mahendran-black.svg?style=flat) ]( https://www.researchgate.net/profile/Amalan_Mahendran )

